<!DOCTYPE html>
<html lang="en-us"><head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta name="generator" content="Hugo 0.84.4" />
	
	<link rel="icon" href="/images/logo.png">
	
	<title>Perceptrón multicapa | Alberto Ortiz</title>
	
	

	<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Perceptrón multicapa"/>
<meta name="twitter:description" content="Las redes neuronales artificiales no son una idea nueva en nuestros tiempos, de hecho existen alrededor de los sesentas, con la investigación de Frank Rosenblatt al crear el perceptrón, pero no es hasta el 2011 que empiezan a emerger como una forma de reconocer patrones, y lo que las hace resurgir es el desarrollo tecnológico, abriendo la posibilidad de implementarlas para su uso en la investigación y en la resolución de problemas."/>

	<meta property="og:title" content="Perceptrón multicapa" />
<meta property="og:description" content="Las redes neuronales artificiales no son una idea nueva en nuestros tiempos, de hecho existen alrededor de los sesentas, con la investigación de Frank Rosenblatt al crear el perceptrón, pero no es hasta el 2011 que empiezan a emerger como una forma de reconocer patrones, y lo que las hace resurgir es el desarrollo tecnológico, abriendo la posibilidad de implementarlas para su uso en la investigación y en la resolución de problemas." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://projectile-man.github.io/blog/perceptron-multicapa/perceptron-multicapa/" /><meta property="article:section" content="blog" />
<meta property="article:published_time" content="2020-08-25T11:40:11+02:00" />
<meta property="article:modified_time" content="2020-08-25T11:40:11+02:00" />



	<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">
	<link href="https://fonts.googleapis.com/css?family=Righteous%7CMerriweather:300,300i,400,400i,700,700i" rel="stylesheet">

	
	<link rel="stylesheet" href="https://projectile-man.github.io/css/medium.d5cc2020527a039e1334e339e0bc1e2bbd7a463ec0b7279d481b9216bffb4d43.css" integrity="sha256-1cwgIFJ6A54TNOM54LweK716Rj7AtyedSBuSFr/7TUM=">

	
	<link rel="stylesheet" href="https://projectile-man.github.io/css/additional.8819b6defcdc6d21280f9b402b00df87ca779135901de6c22e708c62e20184b9.css" integrity="sha256-iBm23vzcbSEoD5tAKwDfh8p3kTWQHebCLnCMYuIBhLk=">

	
	
</head>
<body>
<nav class="navbar navbar-expand-lg navbar-light bg-white fixed-top mediumnavigation nav-down">
    <div class="container pr-0">
        
        <a class="navbar-brand" href="https://projectile-man.github.io/">

            
            <img src="/images/logo.png" alt="logo">
            
        </a>
        

        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarMediumish" aria-controls="navbarSupportedContent"
            aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        
        <div class="collapse navbar-collapse" id="navbarMediumish">
            
            <ul class="navbar-nav ml-auto">
                 
                <li class="nav-item ">
                    <a class="nav-link" href="/blog">Blog</a>
                </li>
                 
                <li class="nav-item ">
                    <a class="nav-link" href="/">About Me</a>
                </li>
                
            </ul>
        </div>
        
    </div>
</nav>


        <div class="site-content">   
            <div class="container">
<div class="mainheading">
    <h1 class="sitetitle">Alberto Ortiz</h1>
    <p class="lead">
         Hola, soy Alberto y este espacio es para compartir mi experiencia relacionada con el grandioso mundo de los datos.
    </p>
</div><div class="main-content">
        
        <div class="container">
            <div class="row">
                
                <div class="col-md-2 pl-0"><div class="share sticky-top sticky-top-offset">
    
    
</div>
</div>
                                
                <div class="col-md-9 flex-first flex-md-unordered">
                    <div class="mainheading">
                        	
                        
                        
                        
                        <div class="row post-top-meta">
                            <div class="col-xs-12 col-md-3 col-lg-2 text-center text-md-left mb-4 mb-md-0 md-nopad-right">
                                <img class="author-thumb" src="/images/author.png" alt="Alberto Ortiz">
                            </div>
                            <div class="col-xs-12 col-md-9 col-lg-10 text-center text-md-left md-nopad-left">
                                <a target="_blank" class="link-dark">Alberto Ortiz</a><br>
                                <span class="author-description">
                                    Data Analyst<br>
                                    <i class="far fa-star"></i>
                                    Aug 25, 2020
                                    <i class="far fa-clock clock"></i>
                                    4 min read
                                </span>					
                            </div>
                        </div>			
                        	
                        
                                                
                        
                        <h1 class="posttitle">Perceptrón multicapa</h1> 
                    </div>

                    
                    
                    
                    

                    
                    <div class="article-post">
                        <p><img src="https://drive.google.com//uc?id=1OCprhc17Usov3sk__dZnLjopVyv9n0CW" alt=""></p>
<p>Las redes neuronales artificiales no son una idea nueva en nuestros tiempos, de hecho existen alrededor
de los sesentas, con la investigación de Frank Rosenblatt al crear el perceptrón, pero no es hasta el 2011
que empiezan a emerger como una forma de reconocer patrones, y lo que las hace resurgir es el desarrollo
tecnológico, abriendo la posibilidad de implementarlas para su uso en la investigación y en la resolución
de problemas.</p>
<p>En una serie de tres posts veremos con la implementación correspondiente , tres tipos de redes neuronales
como forma introductoria para redes neuronales más avanzadas. Las redes neuronales que atenderemos
son la MLP (Perceptrón Multicapa), CNN (Red neuronal Convolucional) y RNN (Red Neuronal
Recurrente). La implementación pertinente de cada una de las redes neuronales que veremos será con la
biblioteca de Keras. En este post nos enfocaremos en el perceptrón multicapa.</p>
<h2 id="perceptrón-multicapa">Perceptrón Multicapa</h2>
<p>Esta red neuronal es usada comunmente en problemas donde se usa una regresión logistica o una regresión lineal. Este tipo de red neuronal no es ideal para procesar datos secuenciales ni multidimencionales. Además tiene la característica de se una red completamente conectada como muestro a continuación.</p>
<p><img src="https://drive.google.com/uc?id=1u4N0PP4NYf63pvohO8AwSjVryZRIr-8K" alt=""></p>
<p>Para el ejemplo vamos a codificar una red neuronal que clasifique números escritos a mano, seguramente ya lo conocerán, es el famoso dataset de MNIST, para la parte del trabajo de clasificación usaremos la regresión logística.</p>
<p><img src="https://drive.google.com/uc?id=1h8uz9dazFE20Khdk4wLGztTp0FxZBJkW" alt=""></p>
<p>Para usar el dataset de MNIST no nos tenemos que preocuparnos por buscarlos y descargarlos, Keras lo hace por nosotros, lo único que se necesita es importar el dataset y en una sola línea ya los tenemos, a continuación el código.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
<span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
<span style="color:#75715e">#importamos el dataset con keras</span>
<span style="color:#f92672">from</span> tensorflow.keras.datasets <span style="color:#f92672">import</span> mnist
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#cargamos el dataset</span>
(x_entrenamiento, y_entrenamiento), (x_prueba, y_prueba) <span style="color:#f92672">=</span> mnist<span style="color:#f92672">.</span>load_data()
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#contamos los valores únicos por número en la etiqueta</span>
unicos, cantidad <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>unique(y_entrenamiento, return_counts<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
print(dict(zip(unique, counts)))
</code></pre></div><pre><code>{
 0: 5923, 
 1: 6742, 
 2: 5958, 
 3: 6131, 
 4: 5842, 
 5: 5421, 
 6: 5918, 
 7: 6265, 
 8: 5851, 
 9: 5949
}
Por etiqueta nos muestra el número de registros para el conjunto de entrenamiento.
</code></pre><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#Ahora para el conjunto de prueba</span>
unicos, cantidad <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>unique(y_prueba, return_counts<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
print(dict(zip(unicos, cantidad)))
</code></pre></div><pre><code>{
 0: 980, 
 1: 1135, 
 2: 1032, 
 3: 1010, 
 4: 982, 
 5: 892, 
 6: 958, 
 7: 1028, 
 8: 974, 
 9: 1009
}
</code></pre><p>El diagrama al modelo que vamos a proponer es el siguiente:</p>
<p><img src="https://drive.google.com/uc?id=1wxGnyFRsDEMpAWr4nzjE43V3jMXEcpKH" alt=""></p>
<p>La capa (layer) <strong>Dense</strong> se refiere a que las neuronas están completamente conectadas en la red, cada neurona en una capa recibe una entrada de todas las neuronas de la capa anterior, mencionamos que es una característica de las MLP.</p>
<p>Para la función de activación usaremos la función ReLU (<strong>Rectified Linear Unit</strong>), dicha función posee una gran ventaja sobre otras funciones de activación, la cual es que no activa a todas las neuronas al mismo tiempo lo que ocasiona un cálculo fácil y eficiente. Además de que es una función de activación que se recomienda usar cuando la red neuronal está completamente conectada.</p>
<p><img src="https://drive.google.com/uc?id=1JPjkmnOUjDo9DloggUrbhBc9w8oSDJw8" alt=""></p>
<p><img src="https://drive.google.com/uc?id=1H-j0rmgaD2p8lUA_aaTXac2K7uWemgFg" alt=""></p>
<p>La capa de <strong>Dropout</strong> se refiere a ignorar neuronas durante la fase de entrenamiento de un conjunto de neuronas que se eligen al azar. La razón por la cual se realiza el dropout es para evitar el over-fitting (sobreajuste).</p>
<p><img src="https://drive.google.com/uc?id=1PBxmlN0snFXFAPM7pArD759xuDMU_LPU" alt=""></p>
<p>En la última capa usaremos la función de activación <strong>&lsquo;softmax&rsquo;</strong>, es una función de activación logística más generalizada que se usa cuando tenemos que realizar una claficación multiclase, en nuestro caso tenemos diez clases (0,1,2,3,4,5,6,7,8,9).</p>
<p>Una vez explicada a grandes rasgos el modelo vamos con la implementación.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#importamos los modulos</span>
<span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
<span style="color:#f92672">from</span> tensorflow.keras.models <span style="color:#f92672">import</span> Sequential
<span style="color:#f92672">from</span> tensorflow.keras.layers <span style="color:#f92672">import</span> Dense, Activation, Dropout
<span style="color:#f92672">from</span> tensorflow.keras.utils <span style="color:#f92672">import</span> to_categorical, plot_model
<span style="color:#f92672">from</span> tensorflow.keras.datasets <span style="color:#f92672">import</span> mnist
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#cargamos el dataset y lo partimos en entranamiento y prueba</span>
(x_entrenamiento, y_entrenamiento), (x_prueba, y_prueba) <span style="color:#f92672">=</span> mnist<span style="color:#f92672">.</span>load_data()
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#calculamos el numero de clases, deben de ser 10</span>
num_clases <span style="color:#f92672">=</span> len(np<span style="color:#f92672">.</span>unique(y_entrenamiento))
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#para que el modelo realice el calculo es necesario transformar las clases, usaremos One hot</span>
y_entrenamiento <span style="color:#f92672">=</span> to_categorical(y_entrenamiento)
y_prueba <span style="color:#f92672">=</span> to_categorical(y_prueba)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#calculamos las dimensionas de la imagen</span>
tamanio_imagen <span style="color:#f92672">=</span> x_entrenamiento<span style="color:#f92672">.</span>shape[<span style="color:#ae81ff">1</span>]
tamanio_entrada <span style="color:#f92672">=</span> tamanio_imagen <span style="color:#f92672">*</span> tamanio_imagen
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#Hacemos un reescalamiento y normalizamos</span>
x_entrenamiento <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>reshape(x_entrenamiento, [<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, tamanio_entrada])
x_entrenamiento <span style="color:#f92672">=</span> x_entrenamiento<span style="color:#f92672">.</span>astype(<span style="color:#e6db74">&#39;float32&#39;</span>) <span style="color:#f92672">/</span> <span style="color:#ae81ff">255</span>
x_prueba <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>reshape(x_prueba, [<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, tamanio_entrada])
x_prueba <span style="color:#f92672">=</span> x_prueba<span style="color:#f92672">.</span>astype(<span style="color:#e6db74">&#39;float32&#39;</span>) <span style="color:#f92672">/</span> <span style="color:#ae81ff">255</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#parametros del modelo</span>
batch_size <span style="color:#f92672">=</span> <span style="color:#ae81ff">128</span>
hidden_units <span style="color:#f92672">=</span> <span style="color:#ae81ff">256</span>
dropout <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.45</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#modelo es un MLP con 3 capas</span>
model <span style="color:#f92672">=</span> Sequential()
model<span style="color:#f92672">.</span>add(Dense(hidden_units, input_dim<span style="color:#f92672">=</span>input_size))
model<span style="color:#f92672">.</span>add(Activation(<span style="color:#e6db74">&#39;relu&#39;</span>))
model<span style="color:#f92672">.</span>add(Dropout(dropout))
model<span style="color:#f92672">.</span>add(Dense(hidden_units))
model<span style="color:#f92672">.</span>add(Activation(<span style="color:#e6db74">&#39;relu&#39;</span>))
model<span style="color:#f92672">.</span>add(Dropout(dropout))
model<span style="color:#f92672">.</span>add(Dense(num_labels))
<span style="color:#75715e">#La salida de la red</span>
model<span style="color:#f92672">.</span>add(Activation(<span style="color:#e6db74">&#39;softmax&#39;</span>))

model<span style="color:#f92672">.</span>compile(loss<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;categorical_crossentropy&#39;</span>, optimizer<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;adam&#39;</span>, metrics<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;accuracy&#39;</span>])
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#y por ultimo entrenamos</span>
model<span style="color:#f92672">.</span>fit(x_entrenamiento, y_entrenamiento, epochs<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>, batch_size<span style="color:#f92672">=</span><span style="color:#ae81ff">128</span>)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># validamos el modelo con los conjuntos de prueba</span>
_, precision <span style="color:#f92672">=</span> model<span style="color:#f92672">.</span>evaluate(x_prueba, y_prueba, batch_size<span style="color:#f92672">=</span>batch_size,verbose<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>)
print(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">Precisión del modelo: </span><span style="color:#e6db74">%.1f%%</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> (<span style="color:#ae81ff">100.0</span> <span style="color:#f92672">*</span> precision))
</code></pre></div><p><img src="https://drive.google.com/uc?id=1ymWe0Nf-Nl45OVFsyxJxiH5YT-KBdQ6q" alt=""></p>
<p>Y obtenemos una precisión muy buena del modelo 98%.
Por último sólo nos queda guardar el modelo por si llegamos a realizar un sistema que reconozca números.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Guardar el Modelo</span>
model<span style="color:#f92672">.</span>save(<span style="color:#e6db74">&#39;modeloMNIST.h5&#39;</span>)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># y para cargarlo y realizar clasificaciones futuras</span>
new_model <span style="color:#f92672">=</span> keras<span style="color:#f92672">.</span>models<span style="color:#f92672">.</span>load_model(<span style="color:#e6db74">&#39;modeloMNIST.h5&#39;</span>)
</code></pre></div><p>Bien por el momento es todo, espero que les sea de ayuda y ahora es su turno de implementar la red neuronal, en los proximos post añadiré otro tipo de arquitecturas con su propia implementación, sin más por el momento les mando un saludo.</p>

                    </div>
                    
                    
                    <div class="after-post-tags">
                        <ul class="tags">
                        
                        <li>
                        <a href="/tags/redes-neuronales">redes neuronales</a>
                        </li>
                        
                        <li>
                        <a href="/tags/python">python</a>
                        </li>
                        
                        <li>
                        <a href="/tags/tensorflow">tensorflow</a>
                        </li>
                        
                        <li>
                        <a href="/tags/keras">keras</a>
                        </li>
                        
                        <li>
                        <a href="/tags/mnist">MNIST</a>
                        </li>
                        
                        </ul>
                    </div>
                    
                    
                    
                    <div class="row PageNavigation d-flex justify-content-between font-weight-bold">
                    
                        <a class="d-block col-md-6" href="https://projectile-man.github.io/blog/intro-timeseries/intro-timeseries/"> &laquo; Introducción a las series de tiempo</a>
                    
                    
                        <a class="d-block col-md-6 text-lg-right" href="https://projectile-man.github.io/blog/preprocesamiento-nlp/preprocesamiento-nlp/">Preprocesamiento de Texto NLP &raquo;</a>
                    
                    <div class="clearfix"></div>
                    </div>
                    
                </div>
                
            </div>
        </div>
        
        
    </div>


            </div>
<footer class="footer">
    <div class="container">
        <div class="row">
            <div class="col-md-6 col-sm-6 text-center text-lg-left">
                &copy; Copyright Alberto Ortiz - All rights reserved
            </div>
            
        </div>
    </div>
</footer>


        </div>


<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>

<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>


<script src="https://projectile-man.github.io/js/mediumish.84218587c174fd40bce82544b98851670f0b124a7324b349c54a4065e2b32ffc.js" integrity="sha256-hCGFh8F0/UC86CVEuYhRZw8LEkpzJLNJxUpAZeKzL/w="></script>
    </body>
</html>
